# KingSCADA_Tag
此工具只适用于KingSCADA3.7的IOServer采集点的新建，采集点位的模板可以修改配置。

目前只支持西门子1200、1500和300系列的PLC，部分AB系列PLC。

工具源码：[https://github.com/qsc20001102/KingSCADA\_Tag](https://github.com/qsc20001102/KingSCADA_Tag)

打包后可执行文件：[KingSCADA\_Tags.zip](/upload/KingSCADA_Tags.zip)

解压后运行exe文件即可。

## 使用说明

### 配置文件选择

解压完成后的文件里面有一个 **tag\_config** 的文件夹，打开后里面是有两个 **SIEMENS** 和 **AB** 两个文件夹代表了设备类型。这个两个文件夹里放着配置采集点位模板的JSON文件，以记事本打开可以自行修改（模板的字段不可修改，只修改后面的值）。目前模板是配置好的，自用的话不需要修改都是和程序对应的。

程序运行后先选择设备类型，选择完成后自动识别改文件夹内的所有模板，可在模板文件中进行选择，选择完成后在下方表格中出现模板的内容。

### CSV数据导入

解压完成后的文件里面有一个 **input\_data** 的文件夹，里面有两个文件是提前做好的测试用的设备数据，使用时直接将实际的设备数据替换里面的内容即可，或者直接复制一份修改也可以。表格共三列。第一行内容不要修改，下面的所有行可以自行修改，AB和SIEMENS的文件第一行是一样的，区别在于第三列的内容，因为采集方式不一样。

点击选择SCV文件，自行选择文件，只要是具备第一行三个列名的文件都能导入进来

**拼接的规则**：

导入文件的设备代号列和模板文件中名称列的所有数据进行拼接，设备名称列和模板文件的描述列进行拼接，拼接地址列和模板文件的地址列进行相加和拼接处理。设备类型不同拼接方式也有区别

### 参数输入

这里面的参数基本所指的基本都是IOserver里面的参数。

起始ID：采集点的起始IO，项目唯一不能重复，程序生成时每行数据加1。

设备名称：在IOServer中对应采集设备的名字。

分组路径：在IOServer中采集点位分组路径，用**“.”**区分层级。

采集链路：采集设备对应的采集链路，一般西门子的设备采用以太网链路，AB使用COM。

IP地址：如果前面选择了以太网，这里出现的就是IP地址，否则出现的就是串口号。

设备系列：依据实际选择

驱动通道：依据实际选择

DB块号：这个只有在选择设备为西门子的时候才会出现，AB没有。

### 生成点表文件

以上所有内容都填写完毕后点击按钮输出点表文件，弹窗窗口显示输出文件的路径。